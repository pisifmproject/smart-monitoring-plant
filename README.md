PISIFM — Setup & Run (Windows / PowerShell)

This document explains how to set up and run the full project (backend + frontend) on a new Windows laptop using PowerShell.

Prerequisites

- Node.js (recommended v18 or newer) and `npm` installed.
- PostgreSQL (or have access to a postgres instance) and credentials.
- Git (to clone the repository).

Repository layout (important paths)

- `pisifmbe/` — backend (Express + TypeScript + Drizzle)
- `pisifmfe/frontend/` — frontend (Vite + Vue 3)

Quick overview

1. Copy repository to laptop.
2. Configure environment variables (backend `.env` or set `DATABASE_URL`).
3. Install dependencies for both projects.
4. Run both services in development.

Step-by-step (PowerShell)

1. Clone repository (if you haven't):

```powershell
# choose a folder
cd C:\projects

# clone
git clone <your-repo-url> PISIFM
cd PISIFM
```

2. Set up database connection

- Create a copy of backend `.env` (if you have an example) or set `DATABASE_URL` environment variable.
- Example `.env` (place in `pisifmbe/.env`):

```
DATABASE_URL=postgres://dbuser:dbpassword@localhost:5432/pisifmdb
```

Replace credentials/host/port/dbname accordingly.

3. Install dependencies (root helper installs both subprojects)

```powershell
# from repo root (where this README is)
npm install            # installs root devDeps (concurrently)
npm run install:all    # installs dependencies for backend and frontend
```

If you prefer to install manually:

```powershell
# backend
npm --prefix pisifmbe install

# frontend
npm --prefix pisifmfe/frontend install
```

4. Start both services (development)

```powershell
# From repo root
npm run dev
```

This runs the backend (ts-node-dev) and the frontend (Vite) concurrently. Default ports:

- Backend: `http://localhost:2000`
- Frontend: `http://localhost:5173`

If you want to run only one service:

```powershell
# Backend only
npm run start:be

# Frontend only
npm run start:fe
```

5. Scheduler & backfill

- The backend contains a daily report scheduler that will generate daily reports at `00:05` local time for the previous day if the backend process is running.
- You can also backfill historical dates using the provided script (uses `ts-node`):

```powershell
# ensure DATABASE_URL is visible to the process (either in pisifmbe/.env or set in this session):
$env:DATABASE_URL = 'postgres://dbuser:dbpassword@localhost:5432/pisifmdb'

# backfill a single date
npx ts-node pisifmbe/src/scripts/backfillDailyReports.ts 2025-11-14

# backfill a range
npx ts-node pisifmbe/src/scripts/backfillDailyReports.ts 2025-11-01 2025-11-14
```

Notes & Troubleshooting

- If you see errors like `SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string`, ensure `DATABASE_URL` is correctly set and is a proper string. You can test connectivity with a quick Node script or `psql` / `pgAdmin`.
- If frontend doesn't show sidebar updates: ensure Vite dev server is running and do a hard reload (Ctrl+F5). If you changed `sideBar.vue` and layout, make sure `dashboardLayout.vue` imports/uses it (this repo's layout has been updated to use the component).
- To inspect backend logs, run backend alone:

```powershell
npm --prefix pisifmbe run dev
```

Verification

- Backend API check (PowerShell):

```powershell
Invoke-RestMethod -Uri http://localhost:2000/api/lvmdp1/daily-report/all
```

- Frontend open: `http://localhost:5173` in browser.

Production notes (optional)

- For production, build frontend (`npm --prefix pisifmfe/frontend run build`) and serve statically.
- For backend use `npm --prefix pisifmbe run build` and a process manager (PM2, systemd) to run `node dist/index.js` and to ensure scheduler runs continuously.

---

Generated by @sptianbgus — ask me to adjust details (DB name, ports, or add `.env.example`).
